@(currentUser: User,
  featuredModules: List[FeaturedModule],
  featuredModuleForm: Form[models.FeaturedModule])

@import helper._
@import helper.twitterBootstrap._

@displayFeaturedModule(featuredModule: FeaturedModule) = {
    <div class="span8 well well-small clearfix featuredModule-@featuredModule.id">
        <div class="pull-left"><strong>@featuredModule.playModule.name</strong> (@featuredModule.creationDate.format("dd/MM/yyyy"))</div>
        <div class="pull-right">
                <a href="javascript:editFeaturedModule('@featuredModule.id', $('#description-@featuredModule.id').text())">Edit</a> |
                <a href="javascript:confirmDelete('@featuredModule.playModule.name', '@routes.FeaturedModules.delete()', @featuredModule.id, function(){removeElement('div.featuredModule-@featuredModule.id')})">Delete</a>
        </div>
        <br/>
        <div class="pull-left">@featuredModule.description</div>
    </div>
}

@admin.adminTemplate("Featured modules", currentUser) {

<div class="row">
    <div class="span3">
        <div class="adminBadge">
            <h4>Add new featured module</h4>
            @helper.form(routes.FeaturedModules.addNewFeaturedModule) {
                <input type="hidden" name="sticky" value="false"/>

                @helper.select(featuredModuleForm("playModule.id"), helper.options(Module.options()))
                @helper.textarea(featuredModuleForm("description"))

                <button type="submit" class="btn">Add</button>
            }
        </div>
    </div>
    <div class="span8">
        <h4>List of Featured Modules</h4>
        @for(featuredModule <- featuredModules) {
            @displayFeaturedModule(featuredModule)
        }
    </div>
</div>


<script type="text/javascript">
    $(function(){
        setAdminNavbar("Featured");
    });

    function editFeaturedModule(id, description, message) {
        message = (typeof message == 'undefined') ? '' : message;
        var template = _.template($('#editFeaturedModuleTemplate').html(),
                                  {id:id, description:description, message:message})
        editAdminSection(template,
                         function(form, data){
                             $('#description-' + data.id).text(data.description);
                         },
                         function(form, message) {});
    }
</script>

<script type="underscore-template" id="editFeaturedModuleTemplate">
    <form>
        <input type="hidden" name="id" value="<%= id %>"/>
        <input type="hidden" name="sticky" value="false"/>
        <input type="hidden" name="targetUrl" value="@routes.FeaturedModules.update"/>
        <p><%= message %></p>
        <table class="formTable">
            <tr>
                <td><label for="description">Description</label></td>
                <td><input type="text" id="description" name="description" value="<%= description %>"/></td>
            </tr>
        </table>
    </form>
</script>
}
